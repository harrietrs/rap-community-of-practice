
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../images/NHS Digital logo_WEB_LEFT.svg">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.5.2">
    
    
      
        <title>Tidy data - NHS Digital</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9f9400aa.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.cbb835fc.min.css">
        
          
          
          <meta name="theme-color" content="#4051b5">
        
      
      
  
  
    
    
  
  
  <style>:root{--md-admonition-icon--<type>:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2 1 21Z"/></svg>');}</style>


    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arial:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Arial";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#tidy-data" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NHS Digital" class="md-header__button md-logo" aria-label="NHS Digital" data-md-component="logo">
      
  <img src="../../images/NHS-Digital-logo_LEFT-WHITE-235x183.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NHS Digital
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tidy data
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/NHSDigital/rap-community-of-practice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RAP Community of Practice
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NHS Digital" class="md-nav__button md-logo" aria-label="NHS Digital" data-md-component="logo">
      
  <img src="../../images/NHS-Digital-logo_LEFT-WHITE-235x183.png" alt="logo">

    </a>
    NHS Digital
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/NHSDigital/rap-community-of-practice" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    RAP Community of Practice
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../support/" class="md-nav__link">
        Support
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Introduction to RAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Introduction to RAP" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Introduction to RAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction_to_RAP/why_is_RAP_important/" class="md-nav__link">
        Why RAP is important
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction_to_RAP/levels_of_RAP/" class="md-nav__link">
        Levels of RAP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Our RAP service
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Our RAP service" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Our RAP service
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/" class="md-nav__link">
        The RAP team
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/building_team_capability/" class="md-nav__link">
        Building team capability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/support-models/" class="md-nav__link">
        Support models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/thin-slice-strategy/" class="md-nav__link">
        Thin slice strategy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/typical-engagement-flow/" class="md-nav__link">
        Typical engagement flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/programme-level-reporting/" class="md-nav__link">
        Programme level reporting
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../our_RAP_service/service-design-and-user-research/" class="md-nav__link">
        Service design and user research
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Implementing RAP
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Implementing RAP" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Implementing RAP
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../code-review/" class="md-nav__link">
        Code review
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../coding-best-practice/" class="md-nav__link">
        Coding best practice
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how-to-publish-your-code-in-the-open/" class="md-nav__link">
        How to publish your code in the open
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../notebooks_versus_ide_development/" class="md-nav__link">
        Notebooks vs IDE development
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../quality-assuring-analytical-outputs/" class="md-nav__link">
        Quality assuring analytical outputs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../technical-workflow/" class="md-nav__link">
        Technical workflow
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Tidy data
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Tidy data
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reference-for-this-guide" class="md-nav__link">
    Reference for this guide
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tidy-data-why-should-i-care" class="md-nav__link">
    Tidy data: Why should I care?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-tidy-data" class="md-nav__link">
    What is tidy data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-tidy-your-data" class="md-nav__link">
    How to tidy your data
  </a>
  
    <nav class="md-nav" aria-label="How to tidy your data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bad-column-headers-as-values-not-as-names" class="md-nav__link">
    1. BAD: Column headers as values, not as names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bad-multiple-variables-stored-in-one-column" class="md-nav__link">
    2. BAD: Multiple variables stored in one column
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bad-variables-stored-in-both-rows-and-columns" class="md-nav__link">
    3. BAD: Variables stored in both rows and columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-bad-multiple-types-of-observations-in-one-table" class="md-nav__link">
    4. BAD: Multiple types of observations in one table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-one-type-of-observational-unit-in-multiple-tables" class="md-nav__link">
    5. One type of observational unit in multiple tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diabetes-example" class="md-nav__link">
    Diabetes example
  </a>
  
    <nav class="md-nav" aria-label="Diabetes example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diabetes-tidy-data-example" class="md-nav__link">
    Diabetes tidy data example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Training resources
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Training resources" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Training resources
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_1" type="checkbox" id="__nav_7_1" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_1">
          Git
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Git" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_1">
          <span class="md-nav__icon md-icon"></span>
          Git
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/git/intro-to-git/" class="md-nav__link">
        Intro to Git
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/git/using-git-collaboratively/" class="md-nav__link">
        Using Git collaboratively
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_2" type="checkbox" id="__nav_7_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_2">
          Python
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Python" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_2">
          <span class="md-nav__icon md-icon"></span>
          Python
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/basic-python-data-analysis-operations/" class="md-nav__link">
        Basic Python data analysis operations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/python-functions/" class="md-nav__link">
        Python functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/visualisation-in-python/" class="md-nav__link">
        Visualisation in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/handling-file-paths/" class="md-nav__link">
        Handling file paths
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/logging-and-error-handling/" class="md-nav__link">
        Logging and error handling in Python
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/project-structure-and-packaging/" class="md-nav__link">
        Project structure and packaging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/virtual-environments/" class="md-nav__link">
        Virtual environments
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/unit-testing/" class="md-nav__link">
        Unit testing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/unit-testing-field-definitions/" class="md-nav__link">
        Unit testing field definitions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/python/backtesting/" class="md-nav__link">
        Back testing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_3" type="checkbox" id="__nav_7_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_3">
          PySpark
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="PySpark" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_3">
          <span class="md-nav__icon md-icon"></span>
          PySpark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/pyspark/" class="md-nav__link">
        About PySpark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/pyspark/logging-and-error-handling/" class="md-nav__link">
        Logging and error handling in PySpark
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/pyspark/pyspark-style-guide/" class="md-nav__link">
        PySpark style guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/pyspark/pyspark-tutorial.py" class="md-nav__link">
        PySpark tutorial
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7_4" type="checkbox" id="__nav_7_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7_4">
          R
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="R" data-md-level="2">
        <label class="md-nav__title" for="__nav_7_4">
          <span class="md-nav__icon md-icon"></span>
          R
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/R/" class="md-nav__link">
        External resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../training_resources/R/git_with_RStudio/" class="md-nav__link">
        Git with RStudio
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../useful_links/" class="md-nav__link">
        Useful links
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#reference-for-this-guide" class="md-nav__link">
    Reference for this guide
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tidy-data-why-should-i-care" class="md-nav__link">
    Tidy data: Why should I care?
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-tidy-data" class="md-nav__link">
    What is tidy data
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-to-tidy-your-data" class="md-nav__link">
    How to tidy your data
  </a>
  
    <nav class="md-nav" aria-label="How to tidy your data">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-bad-column-headers-as-values-not-as-names" class="md-nav__link">
    1. BAD: Column headers as values, not as names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-bad-multiple-variables-stored-in-one-column" class="md-nav__link">
    2. BAD: Multiple variables stored in one column
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-bad-variables-stored-in-both-rows-and-columns" class="md-nav__link">
    3. BAD: Variables stored in both rows and columns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-bad-multiple-types-of-observations-in-one-table" class="md-nav__link">
    4. BAD: Multiple types of observations in one table
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-one-type-of-observational-unit-in-multiple-tables" class="md-nav__link">
    5. One type of observational unit in multiple tables
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diabetes-example" class="md-nav__link">
    Diabetes example
  </a>
  
    <nav class="md-nav" aria-label="Diabetes example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#diabetes-tidy-data-example" class="md-nav__link">
    Diabetes tidy data example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <a href="https://github.com/NHSDigital/rap-community-of-practice/edit/master/docs/implementing_RAP/tidy-data.md" title="Edit this page" class="md-content__button md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg>
  </a>


<h1 id="tidy-data">Tidy Data</h1>
<p>Adopting inconsistent data formats leads to a huge amount of wasted effort and can actually lead to very complex code. By adopting <strong>tidy data format</strong> for your work you can both improve your service to users and simplify your own production pipeline.</p>
<h2 id="reference-for-this-guide">Reference for this guide</h2>
<p><a href="https://vita.had.co.nz/papers/tidy-data.pdf">Hadley Wickham's original paper on tidy format (pdf)</a></p>
<h2 id="tidy-data-why-should-i-care">Tidy data: Why should I care?</h2>
<blockquote>
<p>"Tidy datasets are all alike but every messy dataset is messy in its own way" - Hadley Wickham</p>
</blockquote>
<p>Teams spend a huge amount of effort reshaping and organising data to meet different needs. Tidy data is an attempt to align on a consistent shape for data that can meet most analytical use cases.</p>
<p>By doing as much intermediate data processing as possible in tidy format, you can often achieve huge improvements in code complexity and difficulty of maintaining code.</p>
<p>Note that adopting tidy data for stats production does not mean that your outputs need to be formatted this way. In fact, it is straightforward to get from a consistent tidy format to any unique format you require.</p>
<p>A common bad practice in stats production is to combine data production and data formatting in the same steps. Teams will calculate statistics and at the same time organise that data to match an excel table. This is a natural thing to do as you write code with your output table in mind but this approach leads to multiple problems:</p>
<ul>
<li>Code often gets repeated for different tables - increasing the burden of updating the code each year and increasing the likelihood of errors.</li>
<li>Code is messy and difficult to maintain. Code should do one thing only - either produce the data or format the data.</li>
<li>Once the data has been formatted it becomes less useful for other analysts since it is not machine readable. Before another team can use the data, they need to reformat it.</li>
</ul>
<p>Tidy data offers a consistent format for data analysis purposes that is easy for analysts to produce, easy for humans to interpret, and easy for statistical tools like python and R to read. Tidy data offers more flexibility for readability and simplicity for data analysis purposes, as opposed to 'messy' or non-tidy data that can be have its own structure and rules. Tidy data involves "structuring datasets to facilitate analysis."</p>
<p>Having a consistent way of storing data, like in the tidy format, allows for analysts to easily use the same tools of analysis in a universal way, for example R or Python. Then, time is spent on producing all kinds of published outputs from the tidy structure, other pieces of analysis and data visualisation outputs such as dashboards.</p>
<p>An example of how tidy data enables analysts is that keeping this consistent form of storing data allows analysts to apply longitudinal methods to large datasets that hold years worth of data, critical for healthcare analytics and research.</p>
<h2 id="what-is-tidy-data">What is tidy data</h2>
<ul>
<li><a href="https://r4ds.had.co.nz/tidy-data.html">See Hadley Wickham's excellent book for a great explanation</a></li>
</ul>
<p>It can be confusing in a large dataset which data is an observation (e.g. all measurements for a specific patient across all attributes) and which data is a variable (i.e. the values for a specific type of attribute so the treatment type or the results of a treatment).</p>
<p>There are several conventions on how a tidy dataset is structured but the most common one follows Codd's 3rd normal form (Codd, 1990):</p>
<ul>
<li>Each variable forms a column</li>
<li>Each observation forms a row</li>
<li>Each type of observational unit forms a table</li>
</ul>
<p>Example of tidying up your data</p>
<p>A 'messy' or non-tidy dataset displaying results to treatments applied to patients:</p>
<table>
<thead>
<tr>
<th>Patient_ID</th>
<th>Treatment A</th>
<th>Treatment B</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>N/A</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>11</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>9</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>The same data but in a tidy format:</p>
<table>
<thead>
<tr>
<th>Patient_ID</th>
<th>Treatment</th>
<th>Measured_Variable</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>a</td>
<td>N/A</td>
</tr>
<tr>
<td>2</td>
<td>a</td>
<td>11</td>
</tr>
<tr>
<td>3</td>
<td>a</td>
<td>9</td>
</tr>
<tr>
<td>1</td>
<td>b</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>b</td>
<td>5</td>
</tr>
<tr>
<td>3</td>
<td>b</td>
<td>12</td>
</tr>
</tbody>
</table>
<p>Notice how on this table:</p>
<ul>
<li>Each measured variable (i.e. Treatment, Measured Variable) has its own column.</li>
<li>Each observation/measurement forms a row.</li>
<li>The treatment variable observations form a table of their own, ordering the dataset in a way that connects to the next subtable (i.e. Treatment b).</li>
</ul>
<h2 id="how-to-tidy-your-data">How to tidy your data</h2>
<p>It's easy to imagine tidy data with a small scale dataset however with real world data things can be trickier. Tidy data follow a similar structure but messy data are unique in their own 'messiness'.</p>
<p>In the subsection above, an example of a messy dataset was transformed to a tidy format. Messy data will rarely be that simple and obviously structured in several different ways, depending on what the data is measuring. This subsection will cover the most common issues with messy data and how to apply the tidy format for each example:</p>
<p><strong><em>Note:</em></strong>
<em>It's perfectly valid and understandable to have your own structured way of presenting data in your published outputs, like in the table below (Occupation and Salaries). You should only format your data like this as a final output step - after producing your data in tidy format. Tidy data focuses not so much on the data formatting perspective but on the data production side, as tidy data enables the analyst to focus on analytical questions and not on data processing.</em></p>
<p><strong>&gt; How to transform your tidy data into a publication style output example: <a href="https://hscic365.sharepoint.com/:v:/s/RAPcommunityofpractice/ERwnmjF6HlVFuGmmJI3QzpcBFMm2yPxp46vkWNeAbS5D5g?e=6dQWmM">From tidy to publication output</a>.</strong></p>
<h3 id="1-bad-column-headers-as-values-not-as-names">1. BAD: Column headers as values, not as names</h3>
<p>Using values instead of names as a column header is a quite common form of messy data, however it can be useful for specific cases and computations. In the table below, is an example of various occupations and number of people for each occupation and salary:</p>
<table>
<thead>
<tr>
<th>Occupation</th>
<th>&lt;£20k</th>
<th>£21k-£30k</th>
<th>£31k - £40k</th>
<th>£41k - £50k</th>
<th>£50k +</th>
</tr>
</thead>
<tbody>
<tr>
<td>IT</td>
<td>20</td>
<td>30</td>
<td>60</td>
<td>40</td>
<td>20</td>
</tr>
<tr>
<td>Teacher</td>
<td>30</td>
<td>40</td>
<td>50</td>
<td>40</td>
<td>35</td>
</tr>
<tr>
<td>Doctor</td>
<td>20</td>
<td>40</td>
<td>50</td>
<td>25</td>
<td>40</td>
</tr>
<tr>
<td>Software Dev</td>
<td>10</td>
<td>10</td>
<td>25</td>
<td>25</td>
<td>55</td>
</tr>
<tr>
<td>Solicitor</td>
<td>25</td>
<td>25</td>
<td>60</td>
<td>30</td>
<td>50</td>
</tr>
</tbody>
</table>
<p>In order to transform the table above into a tidier format, the columns are transformed into rows and into 2 columns/variables, one for income and one for number of people (example showing first rows for IT):</p>
<table>
<thead>
<tr>
<th>Occupation</th>
<th>Income</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<td>IT</td>
<td>&lt;£20k</td>
<td>20</td>
</tr>
<tr>
<td>IT</td>
<td>£21k - £30k</td>
<td>30</td>
</tr>
<tr>
<td>IT</td>
<td>£31k - £40k</td>
<td>60</td>
</tr>
<tr>
<td>IT</td>
<td>£41k - £50k</td>
<td>40</td>
</tr>
<tr>
<td>IT</td>
<td>£50k +</td>
<td>20</td>
</tr>
<tr>
<td>Teacher</td>
<td>...</td>
<td>...</td>
</tr>
</tbody>
</table>
<p>You can see that the data goes from wide to long.</p>
<h3 id="2-bad-multiple-variables-stored-in-one-column">2. BAD: Multiple variables stored in one column</h3>
<p>Sometimes a dataset can contain columns which are comprised of multiple underlying variables. In the example table below, data shows an imaginary count of patients in hospitals per region, grouped by gender and age, combined in one column. So for example, m1930 stands for male patients aged 19 to 30 years old.</p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Year</th>
<th>m018</th>
<th>m1930</th>
<th>m3145</th>
<th>m4665</th>
<th>m6680</th>
<th>m81o</th>
<th>f018</th>
<th>f1930</th>
</tr>
</thead>
<tbody>
<tr>
<td>West Midlands</td>
<td>2010</td>
<td>2</td>
<td>5</td>
<td>15</td>
<td>20</td>
<td>25</td>
<td>20</td>
<td>4</td>
<td>6</td>
</tr>
<tr>
<td>London</td>
<td>2010</td>
<td>5</td>
<td>10</td>
<td>15</td>
<td>20</td>
<td>25</td>
<td>40</td>
<td>5</td>
<td>10</td>
</tr>
<tr>
<td>Yorkshire and the Humber</td>
<td>2010</td>
<td>3</td>
<td>9</td>
<td>8</td>
<td>4</td>
<td>20</td>
<td>23</td>
<td>3</td>
<td>9</td>
</tr>
<tr>
<td>North West</td>
<td>2010</td>
<td>5</td>
<td>10</td>
<td>15</td>
<td>12</td>
<td>17</td>
<td>15</td>
<td>2</td>
<td>8</td>
</tr>
</tbody>
</table>
<p>To break apart these columns, different approaches of processing can be used, depending on the column header such as breaking apart the string or if there are separators in the column name (e.g. _ or - or ;), capitals or any type of expression. The results of processing is show below, where the combined column of age and gender has broken into 2 separate variables and adding an extra column for the count of patients (first rows of West Midlands region):</p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Year</th>
<th>Gender</th>
<th>Age</th>
<th>Cases</th>
</tr>
</thead>
<tbody>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>0 - 18</td>
<td>2</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>19 - 30</td>
<td>5</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>31 - 45</td>
<td>15</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>46 - 65</td>
<td>20</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>66 - 80</td>
<td>25</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>m</td>
<td>81 +</td>
<td>20</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>f</td>
<td>0 - 18</td>
<td>4</td>
</tr>
<tr>
<td>West Midlands</td>
<td>2000</td>
<td>f</td>
<td>19 - 30</td>
<td>6</td>
</tr>
</tbody>
</table>
<h3 id="3-bad-variables-stored-in-both-rows-and-columns">3. BAD: Variables stored in both rows and columns</h3>
<p>The next example can be confusing to tidy, as variables are stored in both rows and columns, so Weather station, Year, Month across Day1, Day2 columns and so forth, and tempmax/tempmin (Element column) stored in rows:</p>
<table>
<thead>
<tr>
<th>Weather station</th>
<th>Date</th>
<th>Month</th>
<th>Element</th>
<th>Day1</th>
<th>Day2</th>
<th>Day3...</th>
</tr>
</thead>
<tbody>
<tr>
<td>LS123</td>
<td>2018</td>
<td>1</td>
<td>tempmax</td>
<td>29</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>1</td>
<td>tempmin</td>
<td>10</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>2</td>
<td>tempmax</td>
<td>-</td>
<td>28</td>
<td>25</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>2</td>
<td>tempmin</td>
<td>-</td>
<td>13</td>
<td>13</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>3</td>
<td>tempmax</td>
<td>30</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>3</td>
<td>tempmin</td>
<td>18</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>LS123</td>
<td>2018</td>
<td>4...</td>
<td>tempmax</td>
<td>-</td>
<td>-</td>
<td>-</td>
</tr>
</tbody>
</table>
<p>To tidy this, a new column Date needs to be extracted from Year, Month and Day to correspond to each day of observation. Then variables minimun and maximun Temperatures for each date will be stored in two different columns:</p>
<table>
<thead>
<tr>
<th>Weather station</th>
<th>Date</th>
<th>tempmin</th>
<th>tempmax</th>
</tr>
</thead>
<tbody>
<tr>
<td>LS123</td>
<td>2018-01-01</td>
<td>10</td>
<td>23</td>
</tr>
<tr>
<td>LS123</td>
<td>2018-02-02</td>
<td>13</td>
<td>24</td>
</tr>
<tr>
<td>LS123</td>
<td>2018-02-03</td>
<td>13</td>
<td>25</td>
</tr>
<tr>
<td>LS123</td>
<td>2018-03-01</td>
<td>18</td>
<td>26</td>
</tr>
<tr>
<td>LS123</td>
<td>2018-04-24</td>
<td>17</td>
<td>27</td>
</tr>
<tr>
<td>LS123</td>
<td>2018-05-12</td>
<td>19</td>
<td>29</td>
</tr>
</tbody>
</table>
<p>This table is in a tidy format, there is one row for one day's observations and two new columns, one for each variable of the column Element.</p>
<h3 id="4-bad-multiple-types-of-observations-in-one-table">4. BAD: Multiple types of observations in one table</h3>
<p>The next example is subset of data from the top Billboard songs for each year. This data is not in a tidy format. Weeks 4 - 75 have been edited out for readability purposes. Here, there are several variables, Artist, Song Title, Duration, Date Entered, Week and Rank. (as both are the same for each week the song spent in the billboard.)</p>
<table>
<thead>
<tr>
<th>Year</th>
<th>Artist</th>
<th>Song Title</th>
<th>Duration</th>
<th>Date Entered</th>
<th>Week1</th>
<th>Week2</th>
<th>Week3</th>
</tr>
</thead>
<tbody>
<tr>
<td>1966</td>
<td>The Beatles</td>
<td>We Can Work It Out</td>
<td>3:00</td>
<td>1966-01-08</td>
<td>5</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>1966</td>
<td>The Beatles</td>
<td>Paperback Writer</td>
<td>3:30</td>
<td>1966-06-25</td>
<td>6</td>
<td>3</td>
<td>1</td>
</tr>
<tr>
<td>1966</td>
<td>The Beach Boys</td>
<td>Good Vibrations</td>
<td>3:00</td>
<td>1966-12-10</td>
<td>7</td>
<td>4</td>
<td>2</td>
</tr>
<tr>
<td>1966</td>
<td>The Lovin' Spoonful</td>
<td>Summer in the City</td>
<td>3:20</td>
<td>1966-08-13</td>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<td>1966</td>
<td>Four Tops</td>
<td>Reach Out I'll Be There</td>
<td>3:10</td>
<td>1966-10-15</td>
<td>9</td>
<td>3</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>Transforming this dataset into a tidy version would cause unnecessary duplication of observations (thus cancelling the 1 observation per row norm), in the table below. Imagine if Weeks 4-75 were not removed, so then we would have 72 rows of repeating the same Artist, Song Title and Duration variables. Date Entered has be edited to include the starting week of every week on the billboard:</p>
<table>
<thead>
<tr>
<th>Year</th>
<th>Artist</th>
<th>Song Title</th>
<th>Duration</th>
<th>Date Entered</th>
<th>Week</th>
<th>Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td>1966</td>
<td>The Beach Boys</td>
<td>Good Vibrations</td>
<td>3:00</td>
<td>1966-12-10</td>
<td>1</td>
<td>7</td>
</tr>
<tr>
<td>1966</td>
<td>The Beach Boys</td>
<td>Good Vibrations</td>
<td>3:00</td>
<td>1966-12-17</td>
<td>2</td>
<td>4</td>
</tr>
<tr>
<td>1966</td>
<td>The Beach Boys</td>
<td>Good Vibrations</td>
<td>3:00</td>
<td>1966-12-24</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>1966</td>
<td>The Lovin' Spoonful</td>
<td>Summer in the City</td>
<td>3:20</td>
<td>1966-08-13</td>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>1966</td>
<td>The Lovin' Spoonful</td>
<td>Summer in the City</td>
<td>3:20</td>
<td>1966-08-20</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>1966</td>
<td>The Lovin' Spoonful</td>
<td>Summer in the City</td>
<td>3:20</td>
<td>1966-08-27</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>In this instance, it is recommended that the tidy dataset is split into two, one for each observational unit, the song title and the rank of the song:</p>
<p><strong>Table 1</strong></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Artist</th>
<th>Song Title</th>
<th>Duration</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>The Beatles</td>
<td>We Can Work It Out</td>
<td>3:00</td>
</tr>
<tr>
<td>2</td>
<td>The Beatles</td>
<td>Paperback Writer</td>
<td>3:30</td>
</tr>
<tr>
<td>3</td>
<td>The Beach Boys</td>
<td>Good Vibrations</td>
<td>3:00</td>
</tr>
<tr>
<td>4</td>
<td>The Lovin' Spoonful</td>
<td>Summer in the City</td>
<td>3:20</td>
</tr>
<tr>
<td>5</td>
<td>Four Tops</td>
<td>Reach Out I'll Be There</td>
<td>3:10</td>
</tr>
</tbody>
</table>
<p><strong>Table 2</strong></p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Date Entered</th>
<th>Rank</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>1966-12-10</td>
<td>7</td>
</tr>
<tr>
<td>3</td>
<td>1966-12-17</td>
<td>4</td>
</tr>
<tr>
<td>3</td>
<td>1966-12-24</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>1966-08-13</td>
<td>3</td>
</tr>
<tr>
<td>4</td>
<td>1966-08-20</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>1966-08-27</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>This approach is useful for tidy data buts lacks in data processing tools' capabilities, so in that case these tables will have to be merged again.</p>
<h3 id="5-one-type-of-observational-unit-in-multiple-tables">5. One type of observational unit in multiple tables</h3>
<p>There are datasets that have multiple tables and variables and observational units that are spread throughout those tables. Or these tables change frequently over time. Or there are different approaches to data types, missing data, data formats for each of those tables.</p>
<p>In these cases, it is recommended that each table is 'tidied' up, and then combine each tidy table. To avoid any potential data duplication, adding an extra IDcolumn in each table as well as a column that records the original table/file's name will ensure that each row of data in the merged tidy table is labelled with its source table/file.</p>
<h2 id="diabetes-example">Diabetes example</h2>
<h3 id="diabetes-tidy-data-example"><a href="https://hscic365.sharepoint.com/:v:/s/RAPcommunityofpractice/EXUO-qsiHRNFpPhoqAeVJ8YB-q8fx9dC8YKMaviuh1jqCg?e=pWvR1T">Diabetes tidy data example</a></h3>
<p><em>Disclaimer: the above video will not load for external users.</em></p>
<p>In this video:</p>
<ul>
<li>SQL vs PySpark outputs comparison (messy vs tidy data)</li>
<li>Data shown in suppressed/published form and dummy data</li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 29, 2022</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../technical-workflow/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Technical workflow" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Technical workflow
            </div>
          </div>
        </a>
      
      
        
        <a href="../tools/" class="md-footer__link md-footer__link--next" aria-label="Next: Tools" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Tools
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    <a href="https://github.com/NHSDigital/rap-community-of-practice" target="_blank" rel="noopener" title="NHS Digital Analytical Services" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["search.share", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.39f04ddb.min.js"></script>
      
    
  </body>
</html>